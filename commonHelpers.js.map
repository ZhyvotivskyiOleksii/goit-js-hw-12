{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios'\n\n\naxios.defaults.baseURL = \"https://pixabay.com/api\";\naxios.defaults.params = { key: \"30733650-3915f9571a70fae81f0483ef4\" }\n\nasync function searchImages({ page = 1, per_page = 20, q = \"cat\" }) {\n    const { data } = await axios.get(\"/\", {\n        params: {\n            q,\n            image_type: \"photo\",\n            orientation: \"horizontal\",\n            safesearch: true,\n            page,\n            per_page\n        }\n    })\n\n    return data\n}\n\nexport { searchImages }","function createGalleryMarkup(arr) {\n    return arr.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `<li class=\"gallery-item\">\n    <a class=\"gallery-link\" href=\"${largeImageURL}\">\n      <img\n        class=\"gallery-image\"\n        src=\"${webformatURL}\"\n        alt=\"${tags}\"\n      />\n    </a>\n    <div class=\"image-stats\">\n        <p>Likes <span>${likes}</span></p>\n        <p>Views <span>${views}</span></p>\n        <p>Comments <span>${comments}</span></p>\n        <p>Downloads <span>${downloads}</span></p>\n    </div>\n    </li>`).join(\"\")\n}\n\nexport { createGalleryMarkup }","import iziToast from \"izitoast\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport { searchImages } from \"./js/pixabay-api.js\"\nimport { createGalleryMarkup } from \"./js/render-functions.js\"\n\nconst form = document.querySelector(\".form\");\nconst gallery = document.querySelector(\".gallery\");\nconst loadingText = document.querySelector(\".loading-text\");\nconst loadMoreBtn = document.querySelector(\".load-more\");\nconst simpleGallery = new SimpleLightbox(\".gallery a\", { captionDelay: 250, captionsData: \"alt\" });\n\n\nconst queryParams = {\n    page: 1,\n    per_page: 15,\n    q: \"\",\n    maxPage: 0\n}\n\nform.addEventListener(\"submit\", handleSearch);\n\nconst iziToastErrorOptions = {\n    title: 'Error',\n    message: 'Empty query!',\n    titleColor: 'white',\n    messageColor: 'white',\n    backgroundColor: 'red',\n    position: 'topRight'\n}\n\nasync function handleSearch(event) {\n    event.preventDefault();\n\n    const form = event.currentTarget;\n    queryParams.q = form.elements.query.value.trim();\n\n    if (queryParams.q === \"\") {\n        iziToast.show(iziToastErrorOptions);\n        return;\n    }\n\n    queryParams.page = 1;\n    gallery.innerHTML = \"\";\n    loadingText.classList.remove(\"hidden\");\n    loadMoreBtn.classList.add(\"hidden\");\n\n    try {\n        const { hits, totalHits } = await searchImages(queryParams);\n        if (totalHits === 0) {\n            throw new Error(\"Sorry, there are no images matching your search query. Please try again!\")\n        }\n\n        queryParams.maxPage = Math.ceil(totalHits / queryParams.per_page);\n\n\n        loadingText.classList.add(\"hidden\");\n        gallery.innerHTML = createGalleryMarkup(hits)\n        simpleGallery.refresh()\n\n        if (queryParams.maxPage > 1) {\n            loadMoreBtn.classList.remove(\"hidden\");\n            loadMoreBtn.addEventListener(\"click\", handleLoadMore)\n        }\n\n    } catch (err) {\n        iziToast.show({ ...iziToastErrorOptions, message: err.message });\n        loadingText.classList.add(\"hidden\");\n    } finally {\n        form.reset()\n    }\n}\n\nasync function handleLoadMore() {\n    loadingText.classList.remove(\"hidden\");\n    loadMoreBtn.classList.add(\"hidden\");\n\n    queryParams.page += 1;\n\n\n    try {\n        const { hits } = await searchImages(queryParams);\n\n        loadingText.classList.add(\"hidden\");\n        gallery.insertAdjacentHTML(\"beforeend\", createGalleryMarkup(hits))\n        simpleGallery.refresh()\n\n        window.scrollBy({\n            top: gallery.children[0].getBoundingClientRect().height * 2,\n            behavior: \"smooth\",\n        });\n\n    } catch (err) {\n        iziToast.show({ ...iziToastErrorOptions, message: err.message });\n        loadingText.classList.add(\"hidden\");\n        loadMoreBtn.classList.add(\"hidden\");\n    } finally {\n        if (queryParams.page === queryParams.maxPage) {\n            loadingText.classList.add(\"hidden\");\n            loadMoreBtn.classList.add(\"hidden\");\n            loadMoreBtn.removeEventListener(\"click\", handleLoadMore)\n            iziToast.show({ ...iziToastErrorOptions, message: \"We're sorry, but you've reached the end of search results.\" });\n        } else {\n            loadMoreBtn.classList.remove(\"hidden\");\n        }\n    }\n\n\n}\n"],"names":["axios","searchImages","page","per_page","q","data","createGalleryMarkup","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","form","gallery","loadingText","loadMoreBtn","simpleGallery","SimpleLightbox","queryParams","handleSearch","iziToastErrorOptions","event","iziToast","hits","totalHits","handleLoadMore","err"],"mappings":"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"}